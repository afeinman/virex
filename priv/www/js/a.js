// Generated by CoffeeScript 1.6.2
(function() {
  var parseRE, update_re;

  parseRE = function() {
    var classes, e, flags, idx, re, result, s, splits, string, _i, _len, _ref, _ref1;

    re = $("#re").html();
    re = re.replace(/&nbsp;/g, ' ');
    flags = (_ref = $("#flags").text()) != null ? _ref : "";
    string = (_ref1 = $("#string").html()) != null ? _ref1 : "";
    string = string.replace(/&nbsp;/g, ' ');
    string = string.replace(/\<div\>(\<br\>)?/g, '\n');
    string = string.replace(/\<\/div\>/g, '');
    console.log(">" + re + "< / >" + flags + "< on |" + string + "|");
    try {
      splits = string.split(new RegExp("(" + re + ")", flags));
      classes = ["inter", "match"];
      for (idx = _i = 0, _len = splits.length; _i < _len; idx = ++_i) {
        s = splits[idx];
        if (!((idx % 2 === 1) || (s != null) || (!s.match(/^\s*$/)))) {
          s = '#';
        }
        splits[idx] = "<span class='" + classes[idx % 2] + "'>" + s + "</span>";
      }
      result = splits.join('');
      result = result.replace(' ', '&nbsp;');
      result = result.replace(/\n/, '<div>');
      return $("#results").html(result);
    } catch (_error) {
      e = _error;
      return $("#results").html("There's something fishy in your regexp:<br/>" + e);
    }
  };

  update_re = function() {
    var regex, test_string;

    test_string = $('#string').val().replace(/\r?\n/g, "%0A");
    regex = $("#re").val();
    if (!((regex != null) && (test_string != null))) {
      return;
    }
    $('#match_result').css('background-color', '#EBEBEB');
    $('#match_groups').css('background-color', '#EBEBEB');
    return $.ajax("/regex?text=" + test_string + "&pattern=" + regex).done(function(data) {
      '#results'.html(data);
      $('#match_result').css('background-color', 'white');
      return $('#match_groups').css('background-color', 'white');
    });
  };

  $("#go").click(function() {
    console.log("click!");
    return $('#go').css('animation-name', 'godown');
  });

}).call(this);
